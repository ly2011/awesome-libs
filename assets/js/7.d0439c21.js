(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{196:function(a,t,s){"use strict";s.r(t);var n=s(0),e=Object(n.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"名词解释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#名词解释","aria-hidden":"true"}},[a._v("#")]),a._v(" 名词解释")]),a._v(" "),s("h3",{attrs:{id:"blob"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#blob","aria-hidden":"true"}},[a._v("#")]),a._v(" Blob")]),a._v(" "),s("blockquote",[s("p",[a._v("Blob 对象表示不可变的类似文件对象的原始数据。Blob 表示不一定是 JavaScript 原生形式的数据。File 接口基于 Blob，继承了 blob 的功能并将其扩展使其支持用户系统的文件。")]),a._v(" "),s("p",[a._v("摘自 MDN")])]),a._v(" "),s("p",[a._v("和"),s("strong",[a._v("File 对象")]),a._v("的区别")]),a._v(" "),s("p",[a._v("File 对象就是一个文件，当我们使用"),s("code",[a._v('input type="file"')]),a._v("标签来上传文件，我们在代码里得到的对象就是一个 File 对象。")]),a._v(" "),s("p",[a._v("Blob 对象就是二进制数据，用来包装二进制文件的容器，可以通过"),s("code",[a._v("new Blob()")]),a._v("创建的对象就是 Blob 对象。又比如，在 XMLHttpRequest 里，如果指定 responseType 为 blob，那么得到的返回值也是一个 blob 对象。")]),a._v(" "),s("p",[a._v("File 继承于 Blob")]),a._v(" "),s("h3",{attrs:{id:"filereader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filereader","aria-hidden":"true"}},[a._v("#")]),a._v(" fileReader")]),a._v(" "),s("blockquote",[s("p",[a._v("fileReader 对象允许 Web 应用程序异步读取存储在计算机上的文件（原始数据缓冲区）的内容，使用 File 或 Blob 对象指定要读取的文件或数据。")]),a._v(" "),s("p",[a._v("摘自 MDN")])]),a._v(" "),s("p",[s("code",[a._v("FileReader")]),a._v("是用来读取内存中的文件的 API，支持"),s("code",[a._v("File")]),a._v("和"),s("code",[a._v("Blob")]),a._v("两种格式。")]),a._v(" "),s("h2",{attrs:{id:"转化关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#转化关系","aria-hidden":"true"}},[a._v("#")]),a._v(" 转化关系")]),a._v(" "),s("p",[a._v("这边从使用场景出发，来整理一下。")]),a._v(" "),s("h3",{attrs:{id:"file-转化为-dataurl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file-转化为-dataurl","aria-hidden":"true"}},[a._v("#")]),a._v(" file 转化为 DataURL")]),a._v(" "),s("p",[s("strong",[a._v("场景")]),a._v("： 获取到一个 file 类型的图片，直接在页面中预览。如果等图片上传完服务器返回图片的地址，再赋值给 img 的 src 属性，无疑浪费了时间和带宽。如果直接在 html 中预览？这里就是利用 html5 的新特性，将图片转换为 Base64 的形式显示出来。")]),a._v(" "),s("p",[a._v("下面的方法可以用于在浏览器上预览本地图片或者视频。")]),a._v(" "),s("h4",{attrs:{id:"方法-1：url-createobjecturl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法-1：url-createobjecturl","aria-hidden":"true"}},[a._v("#")]),a._v(" 方法 1：URL.createObjectURL")]),a._v(" "),s("p",[a._v("该方法会根据传入的参数创建一个指向该参数对象的 URL，这个 URL 是一个基于当前文件并且存储在内存中的"),s("code",[a._v("URL")]),a._v("，直到 document 触发了 unload 事件或者执行 revokeObjectURL 来释放。")]),a._v(" "),s("p",[a._v("可以用于在浏览器上预览本地图片或者视频")]),a._v(" "),s("p",[s("strong",[a._v("使用方法如下")])]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("objectURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("createObjectURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("参数：可以为 File 或者 Blob 对象")]),a._v(" "),s("li",[a._v("返回：一段带 hash 的 url，类似"),s("code",[a._v("blob:null/2c5e93e3-f06e-4bf2-8942-1708759bf7a7")])])]),a._v(" "),s("p",[s("strong",[a._v("注意")]),a._v("：在每次调用 "),s("code",[a._v("createObjectURL()")]),a._v("方法时，都会创建一个新的 URL 对象。当不再需要这些 URL 对象时，每个对象必须通过调用"),s("code",[a._v("URL.revokeObjectURL()")]),a._v("方法来释放，让浏览器知道这个 URL 已经不再需要指向对应的文件。"),s("code",[a._v("URL.revokeObjectURL()")]),a._v("方法会释放一个通过"),s("code",[a._v("URL.createObjectURL()")]),a._v("创建的对象 URL。浏览器关闭后自动释放这个对象，但是为了获得最佳性能和内存使用状况，你应该在安全的时机主动释放掉它们。")]),a._v(" "),s("p",[a._v("代码如下")]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" img "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'img'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nimg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("createObjectURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nimg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("width "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),a._v("\nimg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[a._v("onload")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("revokeObjectURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("src"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h4",{attrs:{id:"方法-2：filereader-readasdataurl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法-2：filereader-readasdataurl","aria-hidden":"true"}},[a._v("#")]),a._v(" 方法 2：FileReader.readAsDataURL")]),a._v(" "),s("p",[a._v("该方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成（DONE），并触发 loadend 事件，同时 result 属性将包含一个 data:URL 格式的字符串（base64 编码）以表示所读取文件的内容。")]),a._v(" "),s("p",[s("strong",[a._v("使用方法如下")])]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("FileReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("readAsDataURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("blob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("参数：可以为 File 或者 Blob 对象")]),a._v(" "),s("li",[a._v("返回：图片的 base64 编码。类似"),s("code",[a._v("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIA")])])]),a._v(" "),s("p",[a._v("代码如下")]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" reader "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("FileReader")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nreader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[a._v("onload")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// result属性是包含data:URL格式的字符串（base64编码）表示读取的文件内容")]),a._v("\n  img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("target"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("result\n  img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[a._v("onload")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("dosomething")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 读取file对象")]),a._v("\nreader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("readAsDataURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h4",{attrs:{id:"两种方法的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#两种方法的区别","aria-hidden":"true"}},[a._v("#")]),a._v(" 两种方法的区别")]),a._v(" "),s("p",[a._v("1、执行时机")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("createObjectURL")]),a._v("是同步执行（立即的）")]),a._v(" "),s("li",[s("code",[a._v("FileReader.readAsDataURL")]),a._v("是异步执行")])]),a._v(" "),s("p",[a._v("2、内存使用")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("createObjectURL")]),a._v("返回一段带"),s("code",[a._v("hash")]),a._v("的"),s("code",[a._v("url")]),a._v("，并且一直存储在内存中。")]),a._v(" "),s("li",[s("code",[a._v("FileReader.readAsDataURL")]),a._v("则返回包含很多字符的"),s("code",[a._v("base64")]),a._v("，并会比"),s("code",[a._v("blob url")]),a._v("消耗更多内存，但是在不用的时候会自动从内存中清除（通过垃圾回收机制）")])]),a._v(" "),s("p",[a._v("3、兼容性")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("createObjectURL")]),a._v("支持从 IE10 往上的所有现代浏览器")]),a._v(" "),s("li",[s("code",[a._v("FileReader.readAsDataURL")]),a._v("同样支持从 IE10 往上的所有现代浏览器")])]),a._v(" "),s("p",[a._v("从上面答案不难看出，两者的优劣势")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("使用"),s("code",[a._v("createObjectURL")]),a._v("可以节省性能并更快速，只不过需要在不使用的情况下手动释放内存")])]),a._v(" "),s("li",[s("p",[a._v("如果不太在意设备性能问题，并想获取图片的"),s("code",[a._v("base64")]),a._v("，则推荐使用")])])]),a._v(" "),s("h2",{attrs:{id:"canvas-转化为-dataurl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canvas-转化为-dataurl","aria-hidden":"true"}},[a._v("#")]),a._v(" canvas 转化为 DataURL")]),a._v(" "),s("p",[s("strong",[a._v("场景")]),a._v("： canvas 画出来的图片，需要在其它地方预览或者作为组件之间通信的参数。")]),a._v(" "),s("p",[s("strong",[a._v("使用方法如下")])]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toDataURL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" encoderOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("参数：\n"),s("ul",[s("li",[a._v("type：图片格式，默认为 "),s("code",[a._v("image/png")])]),a._v(" "),s("li",[a._v("encoderOptions：在指定图片格式为 "),s("code",[a._v("image/jpeg")]),a._v("或"),s("code",[a._v("image/webp")]),a._v("的情况下，可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 "),s("code",[a._v("0.92")]),a._v("。其他参数会被忽略。")])])]),a._v(" "),s("li",[a._v("返回：图片的 base64 编码。类似"),s("code",[a._v("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIA")])])]),a._v(" "),s("p",[a._v("使用")]),a._v(" "),s("ul",[s("li",[a._v("当一个内容画到 canvas 上时，我们可以将它生成任何一个格式支持的图片文件。")]),a._v(" "),s("li",[a._v("这个方法也可以用来对图片进行格式转化。比如，file(png 格式) -> canvas -> base64(webp 格式)，参考下图。")]),a._v(" "),s("li",[a._v("这个方法还可以用来压缩图片。")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tKfTcly1g1jvojadcqj30b702kjrn.jpg",alt:""}})]),a._v(" "),s("h2",{attrs:{id:"canvas-转化为-blob"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canvas-转化为-blob","aria-hidden":"true"}},[a._v("#")]),a._v(" canvas 转化为 blob")]),a._v(" "),s("p",[s("strong",[a._v("场景")]),a._v("： canvas 画出来的图片，或者利用 canvas 完成截图功能之后，我们需要把对应的文件上传到服务器。")]),a._v(" "),s("p",[s("strong",[a._v("使用方法如下")])]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toBlob")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" encoderOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("参数：\n"),s("ul",[s("li",[a._v("callback：回调函数，可获得一个单独的"),s("code",[a._v("Blob")]),a._v("对象参数")]),a._v(" "),s("li",[a._v("type："),s("code",[a._v("DOMString")]),a._v("类型，指定图片格式，默认格式为"),s("code",[a._v("image/png")])]),a._v(" "),s("li",[a._v("encoderOptions："),s("code",[a._v("Number")]),a._v("类型，值在 0 与 1 之间，当请求图片格式为"),s("code",[a._v("image/jpeg或者``image/webp时用来指定图片展示质量。如果这个参数的值不在指定类型与范围之内，则使用默认值，其余参数将被忽略。")])])])]),a._v(" "),s("li",[a._v("返回：无返回值")])]),a._v(" "),s("p",[a._v("得到 Blob 对象以后，可以利用 XML2 的"),s("code",[a._v("FormData")]),a._v("对象上传，模拟表单控件，异步上传这个二进制文件。")]),a._v(" "),s("p",[a._v("代码如下")]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("toBlob "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toBlob")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("blob")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n　"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" myForm "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("FormData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\tmyForm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("append")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'image'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" blob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//向表单中添加一个键值对")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"dataurl-或-img-转-canvas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dataurl-或-img-转-canvas","aria-hidden":"true"}},[a._v("#")]),a._v(" DataURL 或 img 转 canvas")]),a._v(" "),s("p",[s("strong",[a._v("场景")]),a._v("： 想要对图片想要进行一些操作，比如加蒙层，修饰，裁剪等等，这些操作可以利用 canvas 的特性去完成。")]),a._v(" "),s("p",[s("strong",[a._v("使用方法如下")])]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("drawImage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" swidth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sheight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" width"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" height"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("参数\n"),s("ul",[s("li",[a._v("image：绘制到上下文的元素。")]),a._v(" "),s("li",[a._v("sx：需要绘制到目标上下文中的，"),s("code",[a._v("image")]),a._v("的矩形（裁剪）选择框的左上角 X 轴坐标。")]),a._v(" "),s("li",[a._v("sy：需要绘制到目标上下文中的，"),s("code",[a._v("image")]),a._v("的矩形（裁剪）选择框的左上角 Y 轴坐标。")]),a._v(" "),s("li",[a._v("swidth：需要绘制到目标上下文中的，"),s("code",[a._v("image")]),a._v("的矩形（裁剪）选择框的宽度。如果不说明，整个矩形（裁剪）从坐标的"),s("code",[a._v("sx")]),a._v("和"),s("code",[a._v("sy")]),a._v("开始，到"),s("code",[a._v("image")]),a._v("的右下角结束。")]),a._v(" "),s("li",[a._v("sheight：需要绘制到目标上下文中的，"),s("code",[a._v("image")]),a._v("的矩形（裁剪）选择框的高度。")])])])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://mdn.mozillademos.org/files/225/Canvas_drawimage.jpg",alt:"drawImage"}})]),a._v(" "),s("p",[a._v("代码如下")]),a._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("dataURLToCanvas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("dataurl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" canvas "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'canvas'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" ctx "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'2d'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("let")]),a._v(" img "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[a._v("onload")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("width "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("width\n    canvas"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("height "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("height\n    ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("drawImage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" dataurl\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])])])},[],!1,null,null,null);t.default=e.exports}}]);